<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course details</title>
</head>
<body>

    <%let msg = ""; %>

    <%if(err_course == 1){
        msg = "This course is already added please add another course";
        err_course = 0; //reset for further registrations
    }%>

    <%if(succ_course == 1){
        msg = "Course added succesfully";
        succ_course = 0; //reset for further registrations
    }%>

    <h5><%=msg%></h5>
    <form action="/courses" method="post">
        <input type="text" name="course_name" id="" placeholder="Course name">
        <br>
        <input type="text" name="course_duration" id="" placeholder="Course duration">
        <br>
        <input type="number" name="course_charges" placeholder="Course charges">
        <br>
        <input type="text" name="course_description" placeholder="Course description">
        <br>
        <button type="submit">Add Course</button>
    </form>

    <table border="2px solid black" id="myTable">
        <thead>
            <th>course_id</th>
            <th>course_name</th>
            <th>duration</th>
            <th>charges</th>
            <th>description</th>
            <th>Edit</th>
            <th>delete</th>
        </thead>
        <tbody id="tableBody">
            <%for(let i = 0; i < courses.length; i++){%>
                <%const {course_id,course_name,duration,charges,description} = courses[i];%>
                <tr class="data-row" data-course-id="<%=course_id%>">
                    <td><%=course_id%></td>
                    <td><%=course_name%></td>
                    <td><%=duration%></td>
                    <td><%=charges%></td>
                    <td><%=description%></td>
                    <td><button class="edit-btn" data-course-id="<%=course_id%>">Edit</button></td>  
                    <td><button class="delete-btn" data-course-id="<%=course_id%>">Delete</button></td> 
                </tr>
            <%}%>
        </tbody>
    </table>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const tableBody = document.getElementById('tableBody');
        
        // Add hover styling
        const style = document.createElement('style');
        style.textContent = `
            .data-row { cursor: pointer; transition: background-color 0.2s; }
            .data-row:hover { background-color: #f5f5f5; }
            .edit-btn, .delete-btn { 
                padding: 5px 10px; 
                cursor: pointer; 
                border: none; 
                border-radius: 3px; 
            }
            .edit-btn { background-color: #4CAF50; color: white; }
            .edit-btn:hover { background-color: #45a049; }
            .delete-btn { background-color: #f44336; color: white; }
            .delete-btn:hover { background-color: #da190b; }
        `;
        document.head.appendChild(style);
        
        // Event delegation for Edit buttons
        tableBody.addEventListener('click', function(event) {
            const target = event.target;
            
            // Handle Edit button click
            if (target.classList.contains('edit-btn')) {
                event.stopPropagation(); // Prevent row click
                const courseId = target.getAttribute('data-course-id');
                
                // Redirect to edit page with course ID
                window.location.href = `/edit-course?id=${courseId}`;
                // Or use: window.location.href = `/edit-course/${courseId}`;
            }
            
            // Handle Delete button click
            if (target.classList.contains('delete-btn')) {
                event.stopPropagation(); // Prevent row click
                const courseId = target.getAttribute('data-course-id');
                
                // Confirm before deleting
                if (confirm('Are you sure you want to delete this course?')) {
                    // Send delete request to server
                    window.location.href = `/delete-course?id=${courseId}`;
                }
            }
            
            // Handle row click (for visual feedback)
            const row = target.closest('.data-row');
            if (row && !target.classList.contains('edit-btn') && !target.classList.contains('delete-btn')) {
                const cells = row.querySelectorAll('td');
                const courseData = {
                    course_id: cells[0].textContent,
                    course_name: cells[1].textContent,
                    duration: cells[2].textContent,
                    charges: cells[3].textContent,
                    description: cells[4].textContent
                };
                
                console.log('Selected Course:', courseData);
                
                // Visual feedback
                document.querySelectorAll('.data-row').forEach(r => {
                    r.style.backgroundColor = '';
                });
                row.style.backgroundColor = '#e3f2fd';
            }
            });
            });
    </script>
</body>
</html>